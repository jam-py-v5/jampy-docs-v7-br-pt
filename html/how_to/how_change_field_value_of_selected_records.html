<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How change field value of selected records &mdash; Jam.py  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
    <link rel="canonical" href="https://jampyapplicationbuilder.com/docs/how_to/how_change_field_value_of_selected_records.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=a354a556"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9bcbadda"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to save edit form without closing it" href="how_to_save_edit_form_without_closing_it.html" />
    <link rel="prev" title="How to link two tables" href="how_to_link_two_tables.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../contents.html" class="icon icon-home"> Jam.py
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Jam.py V7 documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programming/index.html">Jam.py programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">Jam.py FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">How to</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="how_to_install_on_windows.html">How to install Jam.py on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_implement_a_many-to-many_relationship.html">How to implement a many-to-many relationship</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_migrate_development_to_production.html">How to migrate development to production</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_migrate_to_another_database.html">How to migrate to another database</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy/index.html">How to deploy</a></li>
<li class="toctree-l2"><a class="reference internal" href="global_scripts.html">How do I write functions which have a global scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_validate_field_value.html">How to validate field value</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_add_a_button_to_a_form.html">How to add a button to a form</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_execute_script_from_client.html">How to execute script from client</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_change_style_and_attributes_of_elements.html">How to change style and attributes of form elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_create_a_custom_menu.html">How to create a custom menu</a></li>
<li class="toctree-l2"><a class="reference internal" href="to_append_a_record_without_view_form.html">How to append a record using an edit form without opening a view form?</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_prohibit_changing_record.html">How to prohibit changing record</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_link_two_tables.html">How to link two tables</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">How change field value of selected records</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_save_edit_form_without_closing_it.html">How to save edit form without closing it</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_save_changes_to_two_tables_in_same_transaction.html">How to save changes to two tables in same transaction on the server</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_prevent_duplicate_values.html">How to prevent duplicate values in a table field</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_multitenancy.html">How to implement some sort of basic multi-tenancy? For example, to have users with separate data.</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_use_jam_py_with_existing_database.html">Can I use Jam.py with existing database</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_data_from_other_database_tables.html">How can I use data from other database tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_request_from_other_application.html">How I can process a request or get some data from other application or service</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_calculations_in_the_background.html">How can I perform calculations in the background</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_details_inside_details.html">Is it supported to have details inside details?</a></li>
<li class="toctree-l2"><a class="reference internal" href="export_import_csv_files.html">Export to / import from csv files</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication/index.html">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="how_to_migrate_to_v7.html">How to migrate v5 project to v7</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../admin/index.html">Business application builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../refs/index.html">Jam.py class reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../contents.html">Jam.py</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../contents.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">How to</a> &raquo;</li>
      <li>How change field value of selected records</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="how-change-field-value-of-selected-records">
<h1>How change field value of selected records<a class="headerlink" href="#how-change-field-value-of-selected-records" title="Link to this heading">¶</a></h1>
<p>In this example, we will show how to change the “Media Type” field of the “Tracks”
catalog to the same value for the selected records.</p>
<img alt="set_media_type_jampy.png" class="align-center" src="../_images/set_media_type_jampy.png" />
<p>First we set the multiselect attribute of the
<a class="reference internal" href="../refs/client/item/at_table_options.html"><span class="doc">table_options</span></a>
to true to display the check box in the leftmost column of the
“Tracks” table for the user to select the records and
create the <strong>Set media type</strong> button in the
<a class="reference internal" href="../refs/client/item/on_view_form_created.html"><span class="doc">on_view_form_created</span></a>
event handler in the client module of “Tracks”.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">on_view_form_created</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">item</span><span class="p">.</span><span class="nx">table_options</span><span class="p">.</span><span class="nx">multiselect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">  </span><span class="nx">item</span><span class="p">.</span><span class="nx">add_view_button</span><span class="p">(</span><span class="s1">&#39;Set media type&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">set_media_type</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When this button is pressed, the <code class="docutils literal notranslate"><span class="pre">set_media_type</span></code> function defined in the
module is executed.</p>
<p>In this function we create a copy of the “Tracks” item. We pass to the
<a class="reference internal" href="../refs/client/item/m_copy.html"><span class="doc">copy</span></a>
method the handlers option equal to false. It means that all the settings
to the item made in the Form Dialogs in the Application Builder and all the
functions and events defined in the client module of the item will be
unavailable to the copy.</p>
<p>Then we analyze the
<a class="reference internal" href="../refs/client/item/at_selections.html"><span class="doc">selections</span></a>
attribute that is the array of the values of primary key field of the records,
selected by the user.</p>
<p>After it we initialize the dataset of the copy by calling the
<a class="reference internal" href="../refs/client/item/m_open.html"><span class="doc">open</span></a>
method with open_empty option. We also set the fields options
so that the dataset will have only one field media_type.
We set the required attribute of that field to true.</p>
<p>And finally, before calling the
<a class="reference internal" href="../refs/client/item/m_append_record.html"><span class="doc">append_record</span></a>
method, we dynamically assign the
<a class="reference internal" href="../refs/client/item/on_edit_form_created.html"><span class="doc">on_edit_form_created</span></a>
event handler to change the on click event of the <strong>OK</strong> button,
that was defined in the client module of the task.</p>
<p>In the new on click event handler we, first, call the
<a class="reference internal" href="../refs/client/item/m_post.html"><span class="doc">post</span></a>
method to check that the media type value is set, if exception
is raised we call
<a class="reference internal" href="../refs/client/item/m_edit.html"><span class="doc">edit</span></a>
method to allow the user to set it.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">set_media_type</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">copy</span><span class="p">({</span><span class="nx">handlers</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">}),</span>
<span class="w">        </span><span class="nx">selections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">selections</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selections</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">item</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Too many records selected.&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selections</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">rec_count</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">selections</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">selections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">value</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nx">copy</span><span class="p">.</span><span class="nx">open</span><span class="p">({</span><span class="nx">fields</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;media_type&#39;</span><span class="p">],</span><span class="w"> </span><span class="nx">open_empty</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">});</span>

<span class="w">        </span><span class="nx">copy</span><span class="p">.</span><span class="nx">edit_options</span><span class="p">.</span><span class="nx">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Set media type to &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">selections</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">+</span>
<span class="w">          </span><span class="s1">&#39; record(s)&#39;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">copy</span><span class="p">.</span><span class="nx">edit_options</span><span class="p">.</span><span class="nx">history_button</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">        </span><span class="nx">copy</span><span class="p">.</span><span class="nx">media_type</span><span class="p">.</span><span class="nx">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="w">        </span><span class="nx">copy</span><span class="p">.</span><span class="nx">on_edit_form_created</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">c</span><span class="p">.</span><span class="nx">edit_form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;#ok-btn&#39;</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;click.task&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">c</span><span class="p">.</span><span class="nx">post</span><span class="p">();</span>
<span class="w">                    </span><span class="nx">item</span><span class="p">.</span><span class="nx">server</span><span class="p">(</span><span class="s1">&#39;set_media_type&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nx">c</span><span class="p">.</span><span class="nx">media_type</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">selections</span><span class="p">],</span>
<span class="w">                      </span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nx">item</span><span class="p">.</span><span class="nx">alert_error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nx">item</span><span class="p">.</span><span class="nx">selections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">                            </span><span class="nx">item</span><span class="p">.</span><span class="nx">refresh_page</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">                            </span><span class="nx">c</span><span class="p">.</span><span class="nx">cancel_edit</span><span class="p">();</span>
<span class="w">                            </span><span class="nx">item</span><span class="p">.</span><span class="nx">alert</span><span class="p">(</span><span class="nx">selections</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">                              record(s) have been modified.&#39;</span><span class="p">);</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                      </span><span class="p">}</span>
<span class="w">                    </span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">c</span><span class="p">.</span><span class="nx">edit</span><span class="p">();</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">        </span><span class="nx">copy</span><span class="p">.</span><span class="nx">append_record</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When the user clicks the <strong>OK</strong> button, the item’s
<a class="reference internal" href="../refs/client/abstr_item/m_server.html"><span class="doc">server</span></a>
method executes the <code class="docutils literal notranslate"><span class="pre">set_media_type</span></code> function on the server, which changes the
field value of the selected records.</p>
<p>After changing the records on the server we, on the client, unselect the records,
refresh the data of the page, cancel editing by calling the
<a class="reference internal" href="../refs/client/item/m_cancel_edit.html"><span class="doc">cancel_edit</span></a>
method and inform the user of the results.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">set_media_type</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">media_type</span><span class="p">,</span> <span class="n">selections</span><span class="p">):</span>
    <span class="n">copy</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">copy</span><span class="o">.</span><span class="n">set_where</span><span class="p">(</span><span class="n">id__in</span><span class="o">=</span><span class="n">selections</span><span class="p">)</span>
    <span class="n">copy</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;media_type&#39;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">copy</span><span class="p">:</span>
        <span class="n">c</span><span class="o">.</span><span class="n">edit</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">media_type</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">media_type</span>
        <span class="n">c</span><span class="o">.</span><span class="n">post</span><span class="p">()</span>
    <span class="n">c</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="how_to_link_two_tables.html" class="btn btn-neutral float-left" title="How to link two tables" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="how_to_save_edit_form_without_closing_it.html" class="btn btn-neutral float-right" title="How to save edit form without closing it" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Jam.py Team.
      <span class="lastupdated">Last updated on Feb 07, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-122962025-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-122962025-6', {
          'anonymize_ip': false,
      });
    </script>  

  <style>
         .wy-nav-content { max-width: none; }
  </style>



</body>
</html>